% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/auto_import_utf8.R
\name{auto_import_utf8}
\alias{auto_import_utf8}
\title{Automatically import CSV or Excel files and convert character columns to UTF-8}
\usage{
auto_import_utf8(
  file_path,
  file_type = c("csv", "xlsx"),
  sheet = NULL,
  header = TRUE,
  sep = ","
)
}
\arguments{
\item{file_path}{A string specifying the path to the file to import.}

\item{file_type}{A string specifying the file type. Options are \code{"csv"} or \code{"xlsx"}.
Default is \code{"csv"}.}

\item{sheet}{A string or integer specifying the sheet to read from an Excel file.
Ignored if \code{file_type} is \code{"csv"}. Default is \code{NULL}, which means the first sheet is read.}

\item{header}{A logical value indicating whether the first row contains column names.
Default is \code{TRUE}.}

\item{sep}{A string specifying the separator used to separate columns in a CSV file.
Ignored if \code{file_type} is \code{"xlsx"}. Default is \code{","}.}
}
\value{
A data frame with all character columns converted to UTF-8 encoding.
}
\description{
This function imports data from either a CSV or Excel file, detects the file encoding,
and converts character columns to UTF-8. It supports different delimiters for CSV files
and allows specifying a sheet for Excel files. Additionally, the function can handle
header detection and custom separators for CSV files.
}
\details{
\itemize{
\item For CSV files, the function automatically detects the file's encoding using the
\code{stringi::stri_enc_detect()} function and reads the data with \code{data.table::fread()}.
\item For Excel files, the function uses \code{readxl::read_excel()} to read the data.
\item After importing, all character columns are explicitly converted to UTF-8 encoding to ensure consistency.
\item You can specify whether the first row contains column names (\code{header}) and adjust
the separator (\code{sep}) for CSV files.
\item The \code{sheet} parameter allows you to specify which sheet to read when importing Excel files.
}
}
\examples{
\dontrun{
# Import a CSV file with UTF-8 encoding and custom separator
df_csv <- auto_import_utf8("data/file.csv", file_type = "csv", header = TRUE, sep = ";")

# Import an Excel file, reading from the first sheet by default
df_xlsx <- auto_import_utf8("data/file.xlsx", file_type = "xlsx")

# Import an Excel file, specifying a sheet and no header
df_xlsx_sheet <- auto_import_utf8("data/file.xlsx", file_type = "xlsx", sheet = "Sheet2", header = FALSE)
}

}
